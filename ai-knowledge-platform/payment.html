<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AIçŸ¥è¯†å¹³å°æ”¯ä»˜ä¸­å¿ƒ - å®‰å…¨ä¾¿æ·çš„æ”¯ä»˜ä½“éªŒ">
    <meta name="keywords" content="æ”¯ä»˜,ä¼šå‘˜è®¢é˜…,å®‰å…¨æ”¯ä»˜">
    <meta name="author" content="AIçŸ¥è¯†å¹³å°">
    <title>æ”¯ä»˜ä¸­å¿ƒ - AIçŸ¥è¯†å¹³å°</title>

    <!-- Open Graph -->
    <meta property="og:title" content="æ”¯ä»˜ä¸­å¿ƒ - AIçŸ¥è¯†å¹³å°">
    <meta property="og:description" content="å®‰å…¨ä¾¿æ·çš„æ”¯ä»˜ä½“éªŒ">
    <meta property="og:type" content="website">
    <meta property="og:url" content="">
    <meta property="og:image" content="">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">

    <!-- CSS -->
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/components.css">
    <style>
        /* æ”¯ä»˜é¡µé¢ç‰¹å®šæ ·å¼ */
        .payment-page {
            background: var(--bg-primary);
            min-height: 100vh;
        }

        .payment-container {
            max-width: 800px;
            margin: 0 auto;
            padding: calc(64px + var(--spacing-2xl)) var(--spacing-md) var(--spacing-2xl);
        }

        .payment-header {
            text-align: center;
            margin-bottom: var(--spacing-2xl);
        }

        .payment-title {
            font-size: var(--text-3xl);
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: var(--spacing-md);
        }

        .payment-subtitle {
            color: var(--text-secondary);
            font-size: var(--text-lg);
        }

        .payment-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--spacing-2xl);
        }

        .order-summary {
            background: var(--bg-card);
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
        }

        .order-title {
            font-size: var(--text-xl);
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--border-primary);
        }

        .plan-info {
            margin-bottom: var(--spacing-lg);
        }

        .plan-name {
            font-size: var(--text-lg);
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-sm);
        }

        .plan-description {
            color: var(--text-secondary);
            font-size: var(--text-sm);
        }

        .order-details {
            list-style: none;
            margin-bottom: var(--spacing-lg);
        }

        .order-item {
            display: flex;
            justify-content: space-between;
            padding: var(--spacing-sm) 0;
            color: var(--text-secondary);
        }

        .order-item.total {
            border-top: 1px solid var(--border-primary);
            padding-top: var(--spacing-md);
            margin-top: var(--spacing-md);
            font-weight: 600;
            color: var(--text-primary);
            font-size: var(--text-lg);
        }

        .payment-form {
            background: var(--bg-card);
            border: 1px solid var(--border-primary);
            border-radius: var(--radius-lg);
            padding: var(--spacing-xl);
        }

        .payment-title {
            font-size: var(--text-xl);
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--spacing-lg);
            padding-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--border-primary);
        }

        .payment-methods {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-xl);
        }

        .payment-method {
            display: flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-md);
            background: var(--bg-secondary);
            border: 2px solid var(--border-primary);
            border-radius: var(--radius-md);
            cursor: pointer;
            transition: all var(--transition-normal);
        }

        .payment-method:hover {
            border-color: var(--primary-color);
            background: var(--bg-hover);
        }

        .payment-method.selected {
            border-color: var(--primary-color);
            background: rgba(124, 58, 237, 0.1);
        }

        .payment-method input[type="radio"] {
            accent-color: var(--primary-color);
        }

        .payment-method-icon {
            font-size: var(--text-xl);
        }

        .payment-method-name {
            font-weight: 500;
            color: var(--text-primary);
        }

        .coupon-section {
            margin-bottom: var(--spacing-xl);
        }

        .coupon-input-group {
            display: flex;
            gap: var(--spacing-sm);
        }

        .submit-section {
            margin-top: var(--spacing-xl);
        }

        .security-info {
            text-align: center;
            margin-top: var(--spacing-lg);
            color: var(--text-tertiary);
            font-size: var(--text-sm);
        }

        .security-info .icon {
            color: var(--success-color);
            margin-right: var(--spacing-xs);
        }

        @media (max-width: 768px) {
            .payment-content {
                grid-template-columns: 1fr;
            }

            .payment-methods {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body class="payment-page">
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="navbar-container">
            <a href="index.html" class="navbar-brand">
                <div class="navbar-logo">AI</div>
                <span>çŸ¥è¯†å¹³å°</span>
            </a>

            <div class="navbar-nav">
                <a href="index.html" class="navbar-link">é¦–é¡µ</a>
                <a href="articles.html" class="navbar-link">æ–‡ç« </a>
                <a href="membership.html" class="navbar-link">ä¼šå‘˜</a>
                <a href="about.html" class="navbar-link">å…³äº</a>
            </div>

            <div class="navbar-actions">
                <div class="search-box hidden-mobile">
                    <span class="search-icon">ğŸ”</span>
                    <input type="text" class="search-input" placeholder="æœç´¢AIçŸ¥è¯†...">
                </div>

                <a href="auth.html" class="btn btn-ghost auth-login">ç™»å½•</a>
                <a href="auth.html?mode=register" class="btn btn-primary hidden-mobile auth-register">æ³¨å†Œ</a>
                <a href="user.html" class="btn btn-ghost hidden auth-user">
                    <span class="user-name"></span>
                </a>
                <a href="admin.html" class="btn btn-secondary hidden auth-admin">ç®¡ç†</a>

                <button class="navbar-toggle">
                    <span>â˜°</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- æ”¯ä»˜å†…å®¹ -->
    <main class="payment-container">
        <div class="payment-header">
            <h1 class="payment-title">ç¡®è®¤è®¢å•</h1>
            <p class="payment-subtitle">è¯·é€‰æ‹©æ”¯ä»˜æ–¹å¼å®Œæˆè®¢å•</p>
        </div>

        <div class="payment-content">
            <!-- è®¢å•æ‘˜è¦ -->
            <section class="order-summary">
                <h2 class="order-title">è®¢å•è¯¦æƒ…</h2>

                <div class="plan-info">
                    <div class="plan-name" id="plan-name">å¹´åº¦ä¼šå‘˜</div>
                    <div class="plan-description" id="plan-description">æ— é™åˆ¶è®¿é—®æ‰€æœ‰ä»˜è´¹å†…å®¹</div>
                </div>

                <ul class="order-details">
                    <li class="order-item">
                        <span>æ–¹æ¡ˆä»·æ ¼</span>
                        <span id="plan-price">Â¥299.00</span>
                    </li>
                    <li class="order-item">
                        <span>ä¼˜æƒ æŠ˜æ‰£</span>
                        <span id="discount">-Â¥0.00</span>
                    </li>
                    <li class="order-item total">
                        <span>åº”ä»˜é‡‘é¢</span>
                        <span id="total-amount">Â¥299.00</span>
                    </li>
                </ul>

                <div class="coupon-section">
                    <label class="form-label">ä¼˜æƒ åˆ¸ä»£ç </label>
                    <div class="coupon-input-group">
                        <input type="text" id="coupon-code" class="form-input" placeholder="è¾“å…¥ä¼˜æƒ åˆ¸ä»£ç ">
                        <button class="btn btn-outline" onclick="applyCoupon()">åº”ç”¨</button>
                    </div>
                </div>
            </section>

            <!-- æ”¯ä»˜è¡¨å• -->
            <section class="payment-form">
                <h2 class="payment-title">é€‰æ‹©æ”¯ä»˜æ–¹å¼</h2>

                <div class="payment-methods">
                    <label class="payment-method selected">
                        <input type="radio" name="payment-method" value="alipay" checked>
                        <span class="payment-method-icon">ğŸ’°</span>
                        <span class="payment-method-name">æ”¯ä»˜å®</span>
                    </label>
                    <label class="payment-method">
                        <input type="radio" name="payment-method" value="wechat">
                        <span class="payment-method-icon">ğŸ’š</span>
                        <span class="payment-method-name">å¾®ä¿¡æ”¯ä»˜</span>
                    </label>
                    <label class="payment-method">
                        <input type="radio" name="payment-method" value="card">
                        <span class="payment-method-icon">ğŸ’³</span>
                        <span class="payment-method-name">é“¶è¡Œå¡</span>
                    </label>
                    <label class="payment-method">
                        <input type="radio" name="payment-method" value="paypal">
                        <span class="payment-method-icon">ğŸŒ</span>
                        <span class="payment-method-name">PayPal</span>
                    </label>
                </div>

                <div class="submit-section">
                    <button class="btn btn-primary btn-lg" style="width: 100%;" onclick="processPayment()">
                        ç¡®è®¤æ”¯ä»˜ Â¥299.00
                    </button>
                </div>

                <div class="security-info">
                    <p><span class="icon">ğŸ”’</span>å®‰å…¨åŠ å¯†æ”¯ä»˜</p>
                    <p>æ”¯æŒæ‰€æœ‰ä¸»æµæ”¯ä»˜æ–¹å¼</p>
                </div>
            </section>
        </div>
    </main>

    <!-- é¡µè„š -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3>AIçŸ¥è¯†å¹³å°</h3>
                <p style="color: var(--text-secondary); line-height: 1.6; margin-bottom: var(--spacing-lg);">
                    ä¸“æ³¨äºäººå·¥æ™ºèƒ½æŠ€æœ¯å­¦ä¹ å’Œäº¤æµçš„å¹³å°ï¼Œä¸ºAIçˆ±å¥½è€…æä¾›ä¼˜è´¨çš„å­¦ä¹ èµ„æºå’Œä¸“ä¸šæŒ‡å¯¼ã€‚
                </p>
                <div class="footer-social">
                    <a href="#" aria-label="å¾®ä¿¡">ğŸ“±</a>
                    <a href="#" aria-label="å¾®åš">ğŸŒ</a>
                    <a href="#" aria-label="GitHub">ğŸ’»</a>
                    <a href="#" aria-label="é‚®ç®±">ğŸ“§</a>
                </div>
            </div>

            <div class="footer-section">
                <h3>å­¦ä¹ èµ„æº</h3>
                <ul class="footer-links">
                    <li><a href="articles.html">æœ€æ–°æ–‡ç« </a></li>
                    <li><a href="articles.html?category=å…¥é—¨">å…¥é—¨æ•™ç¨‹</a></li>
                    <li><a href="articles.html?category=è¿›é˜¶">è¿›é˜¶è¯¾ç¨‹</a></li>
                    <li><a href="articles.html?category=å®æˆ˜">å®æˆ˜é¡¹ç›®</a></li>
                </ul>
            </div>

            <div class="footer-section">
                <h3>ç¤¾åŒº</h3>
                <ul class="footer-links">
                    <li><a href="#">è®¨è®ºåŒº</a></li>
                    <li><a href="#">é—®ç­”ç¤¾åŒº</a></li>
                    <li><a href="#">ä¸“å®¶ä¸“æ </a></li>
                    <li><a href="#">çº¿ä¸‹æ´»åŠ¨</a></li>
                </ul>
            </div>

            <div class="footer-section">
                <h3>å…³äºæˆ‘ä»¬</h3>
                <ul class="footer-links">
                    <li><a href="about.html">å¹³å°ä»‹ç»</a></li>
                    <li><a href="#">è”ç³»æˆ‘ä»¬</a></li>
                    <li><a href="#">åŠ å…¥æˆ‘ä»¬</a></li>
                    <li><a href="#">åˆä½œä¼™ä¼´</a></li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <div>
                <p>&copy; 2024 AIçŸ¥è¯†å¹³å°. ä¿ç•™æ‰€æœ‰æƒåˆ©.</p>
            </div>
            <div>
                <a href="#" style="color: var(--text-tertiary); margin-right: var(--spacing-md);">éšç§æ”¿ç­–</a>
                <a href="#" style="color: var(--text-tertiary); margin-right: var(--spacing-md);">æœåŠ¡æ¡æ¬¾</a>
                <a href="#" style="color: var(--text-tertiary);">Cookieè®¾ç½®</a>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="js/common.js"></script>

    <!-- é¡µé¢ç‰¹å®šçš„åˆå§‹åŒ– -->
    <script>
        // æ”¯ä»˜æ•°æ®
        let paymentData = {
            plan: 'yearly',
            price: 299,
            discount: 0,
            total: 299,
            method: 'alipay'
        };

        // ç­‰å¾…DOMåŠ è½½å®Œæˆ
        document.addEventListener('DOMContentLoaded', function() {
            // æ£€æŸ¥ç”¨æˆ·ç™»å½•çŠ¶æ€
            if (!UserManager.isAuthenticated()) {
                ToastManager.warning('è¯·å…ˆç™»å½•');
                setTimeout(() => {
                    window.location.href = `auth.html?redirect=payment.html`;
                }, 1000);
                return;
            }

            // åŠ è½½æ”¯ä»˜æ•°æ®
            loadPaymentData();

            // ç»‘å®šäº‹ä»¶
            bindEvents();

            console.log('æ”¯ä»˜é¡µé¢åˆå§‹åŒ–å®Œæˆ');
        });

        function loadPaymentData() {
            const urlParams = new URLSearchParams(window.location.search);

            paymentData.plan = urlParams.get('plan') || 'yearly';
            paymentData.price = parseFloat(urlParams.get('price')) || 299;
            paymentData.total = paymentData.price - paymentData.discount;

            // æ›´æ–°UI
            updateOrderSummary();
        }

        function updateOrderSummary() {
            const planNames = {
                'yearly': 'å¹´åº¦ä¼šå‘˜',
                'monthly': 'æœˆåº¦ä¼šå‘˜',
                'lifetime': 'ç»ˆèº«ä¼šå‘˜'
            };

            const planDescriptions = {
                'yearly': 'æ— é™åˆ¶è®¿é—®æ‰€æœ‰ä»˜è´¹å†…å®¹',
                'monthly': 'æœˆåº¦ä¼šå‘˜æƒé™',
                'lifetime': 'ç»ˆèº«ä¼šå‘˜æƒé™'
            };

            document.getElementById('plan-name').textContent = planNames[paymentData.plan] || 'å¹´åº¦ä¼šå‘˜';
            document.getElementById('plan-description').textContent = planDescriptions[paymentData.plan] || 'æ— é™åˆ¶è®¿é—®æ‰€æœ‰ä»˜è´¹å†…å®¹';
            document.getElementById('plan-price').textContent = `Â¥${paymentData.price.toFixed(2)}`;
            document.getElementById('discount').textContent = `-Â¥${paymentData.discount.toFixed(2)}`;
            document.getElementById('total-amount').textContent = `Â¥${paymentData.total.toFixed(2)}`;

            // æ›´æ–°æŒ‰é’®é‡‘é¢
            const submitBtn = document.querySelector('.submit-section button');
            if (submitBtn) {
                submitBtn.textContent = `ç¡®è®¤æ”¯ä»˜ Â¥${paymentData.total.toFixed(2)}`;
            }
        }

        function bindEvents() {
            // æ”¯ä»˜æ–¹å¼é€‰æ‹©
            document.querySelectorAll('input[name="payment-method"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    // ç§»é™¤æ‰€æœ‰é€‰ä¸­çŠ¶æ€
                    document.querySelectorAll('.payment-method').forEach(method => {
                        method.classList.remove('selected');
                    });

                    // æ·»åŠ å½“å‰é€‰ä¸­çŠ¶æ€
                    this.closest('.payment-method').classList.add('selected');
                    paymentData.method = this.value;
                });
            });
        }

        function applyCoupon() {
            const couponCode = document.getElementById('coupon-code').value.trim();

            if (!couponCode) {
                ToastManager.warning('è¯·è¾“å…¥ä¼˜æƒ åˆ¸ä»£ç ');
                return;
            }

            // æ¨¡æ‹Ÿä¼˜æƒ åˆ¸éªŒè¯
            ToastManager.info('æ­£åœ¨éªŒè¯ä¼˜æƒ åˆ¸...');

            setTimeout(() => {
                if (couponCode === 'SAVE20') {
                    paymentData.discount = paymentData.price * 0.2; // 20% æŠ˜æ‰£
                    paymentData.total = paymentData.price - paymentData.discount;
                    updateOrderSummary();
                    ToastManager.success('ä¼˜æƒ åˆ¸åº”ç”¨æˆåŠŸï¼èŠ‚çœ Â¥' + paymentData.discount.toFixed(2));
                } else if (couponCode === 'AI2024') {
                    paymentData.discount = 50; // å›ºå®š50å…ƒä¼˜æƒ 
                    paymentData.total = paymentData.price - paymentData.discount;
                    updateOrderSummary();
                    ToastManager.success('ä¼˜æƒ åˆ¸åº”ç”¨æˆåŠŸï¼èŠ‚çœ Â¥50.00');
                } else {
                    ToastManager.error('ä¼˜æƒ åˆ¸ä»£ç æ— æ•ˆ');
                }
            }, 1000);
        }

        function processPayment() {
            if (!UserManager.isAuthenticated()) {
                ToastManager.warning('è¯·å…ˆç™»å½•');
                return;
            }

            ToastManager.info('æ­£åœ¨å¤„ç†æ”¯ä»˜...');

            // æ¨¡æ‹Ÿæ”¯ä»˜å¤„ç†
            setTimeout(() => {
                // æ¨¡æ‹Ÿæ”¯ä»˜æˆåŠŸ
                const user = UserManager.currentUser;
                if (user) {
                    user.isPremium = true;
                    user.membershipPlan = paymentData.plan;
                    user.membershipExpiry = new Date(Date.now() + 365 * 24 * 60 * 60 * 1000).toISOString(); // ä¸€å¹´åè¿‡æœŸ
                    UserManager.login(user);
                }

                ToastManager.success('æ”¯ä»˜æˆåŠŸï¼æ¬¢è¿æˆä¸ºä¼šå‘˜');

                // è·³è½¬åˆ°æˆåŠŸé¡µé¢æˆ–ç”¨æˆ·ä¸­å¿ƒ
                setTimeout(() => {
                    window.location.href = 'user.html';
                }, 2000);
            }, 2000);
        }
    </script>
</body>
</html>